# 📝 日志系统使用说明

## 📋 功能概述

现在程序运行日志会自动保存到 `logs/` 目录，按日期归档，格式为：`deepseekok2-YYYYMMDD.log`

## 🚀 快速开始

### 1. 日志文件位置
```
logs/
├── deepseekok2-20251123.log  # 今天的日志
├── deepseekok2-20251122.log  # 昨天的日志
└── ...
```

### 2. 查看日志

#### 📊 列出所有日志文件
```bash
python3 view_logs.py list
```

#### 📋 查看最新日志（默认50行）
```bash
python3 view_logs.py tail
```

#### 📋 查看最新日志（指定行数）
```bash
python3 view_logs.py tail 100
```

#### 📋 查看指定日志文件
```bash
python3 view_logs.py tail deepseekok2-20251123.log 20
```

#### 🔍 搜索日志内容
```bash
# 搜索所有日志文件
python3 view_logs.py search "BUY信号"

# 搜索指定日志文件
python3 view_logs.py search deepseekok2-20251123.log "ERROR"
```

#### ❓ 查看帮助
```bash
python3 view_logs.py help
```

## 📁 日志格式

每行日志包含：
```
[时间戳] [日志级别] 日志内容
```

示例：
```
[2025-11-23 14:06:44] [INFO] 🤖 日志系统测试开始
[2025-11-23 14:06:44] [WARNING] ⚠️ 这是一个警告日志测试
[2025-11-23 14:06:44] [ERROR] ❌ 这是一个错误日志测试
```

## 🔄 自动管理

- ✅ **每日自动归档**：每天0点自动创建新的日志文件
- ✅ **自动清理**：保留最近30天的日志，自动删除旧文件
- ✅ **实时写入**：日志实时写入文件，无需重启程序

## 🎯 使用场景

| 场景 | 命令 |
|------|------|
| 查看最新交易 | `python3 view_logs.py tail 20` |
| 查找错误信息 | `python3 view_logs.py search "ERROR"` |
| 查找BUY信号 | `python3 view_logs.py search "BUY"` |
| 查找SELL信号 | `python3 view_logs.py search "SELL"` |
| 查看警告信息 | `python3 view_logs.py search "⚠️"` |

## 🛠️ 技术实现

### 日志系统组件
- **logger_config.py**: 核心日志配置
- **view_logs.py**: 日志查看工具
- **setup_logging.py**: 自动转换脚本

### 日志级别
- **INFO**: 普通信息（带表情符号的日志）
- **WARNING**: 警告信息（⚠️🚨）
- **ERROR**: 错误信息（❌💀）
- **DEBUG**: 调试信息

### 文件命名规则
```
deepseekok2-YYYYMMDD.log
示例: deepseekok2-20251123.log
```

## 📊 与Docker日志对比

| 功能 | 新日志系统 | Docker logs |
|------|------------|-------------|
| 持久化 | ✅ 永久保存 | ❌ 容器删除即丢失 |
| 按天归档 | ✅ 自动归档 | ❌ 单一文件 |
| 搜索功能 | ✅ 支持关键词搜索 | ❌ 需要grep |
| 文件大小 | ✅ 自动清理旧文件 | ❌ 无限增长 |
| 查看历史 | ✅ 支持任意日期 | ❌ 仅限当前容器 |
| 实时性 | ✅ 实时写入 | ✅ 实时输出 |

## 🚨 注意事项

1. **备份重要日志**：重要交易期间的日志建议手动备份
2. **磁盘空间**：确保有足够的磁盘空间存储日志
3. **权限**：确保程序有写入logs目录的权限
4. **时区**：日志时间使用系统本地时区

## 🆘 故障排除

### 日志文件未生成
```bash
# 检查logs目录权限
ls -la logs/

# 手动创建logs目录
mkdir -p logs
chmod 755 logs
```

### 日志查看工具无法使用
```bash
# 检查Python环境
python3 --version

# 手动查看日志文件
cat logs/deepseekok2-20251123.log
```

### 日志文件过大
```bash
# 手动清理旧日志
find logs/ -name "deepseekok2-*.log" -mtime +30 -delete
```

## 📈 高级用法

### 1. 实时监控日志
```bash
# Linux/Mac
tail -f logs/deepseekok2-`date +%Y%m%d`.log

# 查看实时BUY信号
tail -f logs/deepseekok2-`date +%Y%m%d`.log | grep "BUY"
```

### 2. 统计日志信息
```bash
# 统计今天的交易次数
grep -c "BUY\|SELL" logs/deepseekok2-`date +%Y%m%d`.log

# 统计错误次数
grep -c "ERROR" logs/deepseekok2-`date +%Y%m%d`.log
```

### 3. 多日期对比
```bash
# 对比昨天和今天的交易
python3 view_logs.py tail deepseekok2-`date -d yesterday +%Y%m%d`.log 10
python3 view_logs.py tail deepseekok2-`date +%Y%m%d`.log 10
```

## 🎉 总结

新的日志系统提供了：
- ✅ **持久化存储**：不再依赖Docker容器
- ✅ **智能归档**：按天自动归档
- ✅ **便捷查看**：多种查看和搜索方式
- ✅ **自动清理**：避免磁盘空间问题
- ✅ **实时监控**：支持实时查看和搜索

现在你可以轻松查看程序运行历史，快速定位问题，分析交易记录！